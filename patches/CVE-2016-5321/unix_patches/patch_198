--- /experiment/vulnloc/libtiff/CVE-2016-5321/src/tools/tiffcrop.c	2023-09-14 15:19:58.656097057 +0000
+++ /experiment/vulnloc/libtiff/CVE-2016-5321/src/tools/tiffcrop.c	2023-09-14 15:20:33.255303364 +0000
@@ -6152,7 +6152,7 @@
          image->orientation = ORIENTATION_TOPLEFT;
    }
 
-   int __fuzzfix527 = ((bps == 0) || (spp == 0));
+   int __fuzzfix527=(((bps==((in->tif_nfields)+0))||(spp==0))||(input_compression>0));
    if (__fuzzfix527) {
      TIFFError("loadImage",
                "Invalid samples per pixel (%d) or bits per sample (%d)", spp,
