--- /experiment/vulnloc/libtiff/CVE-2016-5321/src/tools/tiffcrop.c	2023-09-14 15:19:58.656097057 +0000
+++ /experiment/vulnloc/libtiff/CVE-2016-5321/src/tools/tiffcrop.c	2023-09-14 15:20:34.975263904 +0000
@@ -2304,7 +2304,7 @@
     int __fuzzfix156 = (dirnum == (MAX_IMAGES - 1));
     if (__fuzzfix156) dirnum = total_images - 1;
 
-    int __fuzzfix157 = (dirnum > (total_images));
+    int __fuzzfix157=((dirnum>total_images)||((crop.combined_length)<=next_image));
     if (__fuzzfix157) {
       TIFFError (TIFFFileName(in), 
       "Invalid image number %d, File contains only %d images", 
