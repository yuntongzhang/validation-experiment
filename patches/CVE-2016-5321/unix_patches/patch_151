--- /experiment/vulnloc/libtiff/CVE-2016-5321/src/tools/tiffcrop.c	2023-09-14 15:19:58.656097057 +0000
+++ /experiment/vulnloc/libtiff/CVE-2016-5321/src/tools/tiffcrop.c	2023-09-14 15:20:32.603318322 +0000
@@ -2285,7 +2285,7 @@
     total_images = TIFFNumberOfDirectories(in);
     int __fuzzfix155 = (image_count == 0);
     if (__fuzzfix155) {
-      dirnum = 0;
+      dirnum=(((in->tif_name)>=32767)&&((in->tif_name)!=0));
       total_pages = total_images; /* Only valid with single input file */
     } else {
       dirnum = (tdir_t)(imagelist[next_image] - 1);
