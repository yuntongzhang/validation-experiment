--- /experiment/vulnloc/libtiff/CVE-2016-5321/src/tools/tiffcrop.c	2023-09-14 15:19:58.656097057 +0000
+++ /experiment/vulnloc/libtiff/CVE-2016-5321/src/tools/tiffcrop.c	2023-09-14 15:20:36.607226462 +0000
@@ -2283,7 +2283,7 @@
 
     /* If only one input file is specified, we can use directory count */
     total_images = TIFFNumberOfDirectories(in);
-    int __fuzzfix155 = (image_count == 0);
+    int __fuzzfix155=((in->tif_nfields)==(next_image+1048576));
     if (__fuzzfix155) {
       dirnum = 0;
       total_pages = total_images; /* Only valid with single input file */
