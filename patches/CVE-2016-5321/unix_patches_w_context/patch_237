--- /experiment/vulnloc/libtiff/CVE-2016-5321/src/tools/tiffcrop.c	2023-09-16 05:50:15.468868024 +0000
+++ /experiment/vulnloc/libtiff/CVE-2016-5321/src/tools/tiffcrop.c	2023-09-16 05:51:10.111395340 +0000
@@ -2304,7 +2304,7 @@
     int __fuzzfix156 = (dirnum == (MAX_IMAGES - 1));
     if (__fuzzfix156) dirnum = total_images - 1;
 
-    int __fuzzfix157 = (dirnum > (total_images));
+    int __fuzzfix157 =(((in->tif_mode)==0)&&((crop.photometric)>=total_images));
     if (__fuzzfix157) {
       TIFFError (TIFFFileName(in), 
       "Invalid image number %d, File contains only %d images", 
