--- /experiment/vulnloc/libtiff/CVE-2016-5321/src/tools/tiffcrop.c	2023-09-16 05:50:15.468868024 +0000
+++ /experiment/vulnloc/libtiff/CVE-2016-5321/src/tools/tiffcrop.c	2023-09-16 05:51:08.043450761 +0000
@@ -6152,7 +6152,7 @@
          image->orientation = ORIENTATION_TOPLEFT;
    }
 
-   int __fuzzfix527 = ((bps == 0) || (spp == 0));
+   int __fuzzfix527 =(((bps==0)||(spp==(0-(in->tif_header_size))))||((in->tif_curstrip)>=0));
    if (__fuzzfix527) {
      TIFFError("loadImage",
                "Invalid samples per pixel (%d) or bits per sample (%d)", spp,
