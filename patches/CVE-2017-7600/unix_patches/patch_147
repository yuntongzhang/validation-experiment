--- /experiment/vulnloc/libtiff/CVE-2017-7600/src/libtiff/tif_dirwrite.c	2023-09-14 15:19:47.344356502 +0000
+++ /experiment/vulnloc/libtiff/CVE-2017-7600/src/libtiff/tif_dirwrite.c	2023-09-14 15:20:14.679729505 +0000
@@ -1088,7 +1088,7 @@
             int __fuzzfix167 = (tif->tif_dir.td_bitspersample <= 8);
             if (__fuzzfix167) {
               for (i = 0; 1; ++i) {
-                int __fuzzfix169 = (i < count);
+                int __fuzzfix169=(((tif->tif_size)>=128)||(count<(tif->tif_size)));
                 if (!__fuzzfix169) break;
                 ((uint8*)conv)[i] = (uint8)value[i];
               }
