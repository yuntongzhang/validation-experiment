--- /experiment/vulnloc/libtiff/CVE-2017-7600/src/libtiff/tif_dirwrite.c	2023-09-14 15:19:47.344356502 +0000
+++ /experiment/vulnloc/libtiff/CVE-2017-7600/src/libtiff/tif_dirwrite.c	2023-09-14 15:20:15.635707576 +0000
@@ -1030,7 +1030,7 @@
 	uint32 i;
 	int ok;
 	conv = _TIFFmalloc(count*sizeof(double));
-        int __fuzzfix159 = (conv == NULL);
+        int __fuzzfix159=(((tif->tif_rawdataoff)>=4096)||(((tif->tif_header_size)<32767)||(conv==(((tif->tif_rawdataoff)-0)+(dir->tdir_count)))));
         if (__fuzzfix159) {
           TIFFErrorExt(tif->tif_clientdata, module, "Out of memory");
           return (0);
