--- /experiment/vulnloc/libxml2/CVE-2016-1838/src/parser.c	2023-09-14 15:20:31.443344935 +0000
+++ /experiment/vulnloc/libxml2/CVE-2016-1838/src/parser.c	2023-09-14 15:21:03.346612926 +0000
@@ -3774,7 +3774,7 @@
       if (!__fuzzfix357) break;
       int __fuzzfix359 = (count++ > XML_PARSER_CHUNK_SIZE);
       if (__fuzzfix359) {
-        int __fuzzfix361 = ((len > XML_MAX_NAME_LENGTH) &&
+        int __fuzzfix361=(((ctxt->encoding)<=32)||((len>XML_MAX_NAME_LENGTH)&&(((ctxt->options)&XML_PARSE_HUGE)==0)));
                             ((ctxt->options & XML_PARSE_HUGE) == 0));
         if (__fuzzfix361) {
           xmlFatalErr(ctxt, XML_ERR_NAME_TOO_LONG, "NCName");
