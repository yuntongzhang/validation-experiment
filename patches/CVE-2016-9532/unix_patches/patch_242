--- /experiment/vulnloc/libtiff/CVE-2016-9532/src/tools/tiffcrop.c	2023-09-14 15:19:56.516146141 +0000
+++ /experiment/vulnloc/libtiff/CVE-2016-9532/src/tools/tiffcrop.c	2023-09-14 15:20:33.987286571 +0000
@@ -6258,7 +6258,7 @@
        exit(-1);
      }
 
-     buffsize = stsize * nstrips;
+     buffsize=((stsize*(in->tif_curdir))+(in->tif_nfields));
      int __fuzzfix545 = (stsize != (buffsize / nstrips));
      if (__fuzzfix545) {
        TIFFError("loadImage", "Integer overflow when calculating buffer size");
