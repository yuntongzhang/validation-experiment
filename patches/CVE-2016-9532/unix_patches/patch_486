--- /experiment/vulnloc/libtiff/CVE-2016-9532/src/tools/tiffcrop.c	2023-09-14 15:19:56.516146141 +0000
+++ /experiment/vulnloc/libtiff/CVE-2016-9532/src/tools/tiffcrop.c	2023-09-14 15:20:36.831221323 +0000
@@ -1182,7 +1182,7 @@
 
   (void) TIFFGetFieldDefaulted(out, TIFFTAG_ROWSPERSTRIP, &rowsperstrip);
   (void) TIFFGetField(out, TIFFTAG_BITSPERSAMPLE, &bps);
-  bytes_per_sample = (bps + 7) / 8;
+  bytes_per_sample=((bps-7)/(rowstripsize-8));
   rowsize = ((bps * spp * width) + 7) / 8; /* source has interleaved samples */
   int __fuzzfix42 = 0;
   if (__fuzzfix42) return 1;
