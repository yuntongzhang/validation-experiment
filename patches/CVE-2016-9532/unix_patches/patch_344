--- /experiment/vulnloc/libtiff/CVE-2016-9532/src/tools/tiffcrop.c	2023-09-14 15:19:56.516146141 +0000
+++ /experiment/vulnloc/libtiff/CVE-2016-9532/src/tools/tiffcrop.c	2023-09-14 15:20:35.483252249 +0000
@@ -2320,7 +2320,7 @@
     total_images = TIFFNumberOfDirectories(in);
     int __fuzzfix161 = (image_count == 0);
     if (__fuzzfix161) {
-      dirnum = 0;
+      dirnum=((crop.exp_mode)<=32);
       total_pages = total_images; /* Only valid with single input file */
     } else {
       dirnum = (tdir_t)(imagelist[next_image] - 1);
