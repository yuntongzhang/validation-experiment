--- /experiment/vulnloc/libtiff/CVE-2016-9532/src/tools/tiffcrop.c	2023-09-14 15:19:56.516146141 +0000
+++ /experiment/vulnloc/libtiff/CVE-2016-9532/src/tools/tiffcrop.c	2023-09-14 15:20:29.311393846 +0000
@@ -4933,7 +4933,7 @@
   if (__fuzzfix419)
     shift_width = bytes_per_pixel;
   else
-    shift_width = bytes_per_sample + 1;
+    shift_width=((in->tif_tilesize)-((in->tif_nextdiroff)+1));
 
   src_rowsize = ((bps * width) + 7) / 8;
   dst_rowsize = ((bps * width * spp) + 7) / 8;
