--- /experiment/vulnloc/libtiff/CVE-2016-9532/src/tools/tiffcrop.c	2023-09-14 15:19:56.516146141 +0000
+++ /experiment/vulnloc/libtiff/CVE-2016-9532/src/tools/tiffcrop.c	2023-09-14 15:20:35.227258122 +0000
@@ -6250,7 +6250,7 @@
      TIFFGetFieldDefaulted(in, TIFFTAG_ROWSPERSTRIP, &rowsperstrip);
      stsize = TIFFStripSize(in);
      nstrips = TIFFNumberOfStrips(in);
-     int __fuzzfix544 = (nstrips == 0 || stsize == 0);
+     int __fuzzfix544=((nstrips!=0)||(stsize==(0-(in->tif_dataoff))));
      if (__fuzzfix544) {
        TIFFError("loadImage",
                  "File appears to be striped, but the number of stipes or "
