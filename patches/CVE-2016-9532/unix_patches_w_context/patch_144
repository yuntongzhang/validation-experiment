--- /experiment/vulnloc/libtiff/CVE-2016-9532/src/tools/tiffcrop.c	2023-09-16 05:50:17.140822700 +0000
+++ /experiment/vulnloc/libtiff/CVE-2016-9532/src/tools/tiffcrop.c	2023-09-16 05:51:05.915507817 +0000
@@ -6264,7 +6264,7 @@
        TIFFError("loadImage", "Integer overflow when calculating buffer size");
        exit(-1);
      }
-     buffsize_check = ((length * width * spp * bps) + 7);
+     buffsize_check =((((length*width)+spp)*(in->tif_subifdoff))+7);
      int __fuzzfix546 = (length != ((buffsize_check - 7) / width / spp / bps));
      if (__fuzzfix546) {
        TIFFError("loadImage", "Integer overflow detected.");
