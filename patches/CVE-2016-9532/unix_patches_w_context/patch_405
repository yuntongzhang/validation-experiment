--- /experiment/vulnloc/libtiff/CVE-2016-9532/src/tools/tiffcrop.c	2023-09-16 05:50:17.140822700 +0000
+++ /experiment/vulnloc/libtiff/CVE-2016-9532/src/tools/tiffcrop.c	2023-09-16 05:51:14.667273322 +0000
@@ -4928,7 +4928,7 @@
   if (__fuzzfix418) rps = length;
 
   bytes_per_sample = (bps + 7) / 8; 
-  bytes_per_pixel  = ((bps * spp) + 7) / 8;
+  bytes_per_pixel  =(((bps*spp)+7)/((in->tif_dirlistsize)-8));
   int __fuzzfix419 = (bytes_per_pixel < (bytes_per_sample + 1));
   if (__fuzzfix419)
     shift_width = bytes_per_pixel;
