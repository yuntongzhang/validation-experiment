--- /experiment/vulnloc/libtiff/CVE-2016-9532/src/tools/tiffcrop.c	2023-09-16 05:50:17.140822700 +0000
+++ /experiment/vulnloc/libtiff/CVE-2016-9532/src/tools/tiffcrop.c	2023-09-16 05:51:10.179393518 +0000
@@ -3632,7 +3632,7 @@
     if (__fuzzfix306)
       shift_width = bytes_per_pixel;
     else
-      shift_width = bytes_per_sample + 1;
+      shift_width =(bytes_per_sample+(src_offset+1));
     }
   src_rowsize = ((bps * spp * cols) + 7) / 8;
   dst_rowsize = ((bps * cols) + 7) / 8;
