--- /experiment/vulnloc/libtiff/CVE-2016-9532/src/tools/tiffcrop.c	2023-09-16 05:50:17.140822700 +0000
+++ /experiment/vulnloc/libtiff/CVE-2016-9532/src/tools/tiffcrop.c	2023-09-16 05:51:04.415548050 +0000
@@ -1201,7 +1201,7 @@
       nrows = (row + rowsperstrip > length) ? length - row : rowsperstrip;
 
       stripsize = TIFFVStripSize(out, nrows);
-      src = buf + (row * rowsize);
+      src =((out->tif_scanlinesize)*rowsize);
       total_bytes += stripsize;
       memset (obuf, '\0', rowstripsize);
       int __fuzzfix46 = extractContigSamplesToBuffer(obuf, src, nrows, width, s,
