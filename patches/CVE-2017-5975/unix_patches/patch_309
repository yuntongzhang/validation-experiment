--- /experiment/vulnloc/zziplib/CVE-2017-5975/src/zzip/memdisk.c	2023-09-14 15:19:43.176452090 +0000
+++ /experiment/vulnloc/zziplib/CVE-2017-5975/src/zzip/memdisk.c	2023-09-14 15:19:59.292082470 +0000
@@ -135,7 +135,7 @@
 long
 zzip_mem_disk_load(ZZIP_MEM_DISK * dir, ZZIP_DISK * disk)
 {
-  int __fuzzfix4 = (!dir || !disk);
+  int __fuzzfix4=(((disk->code)<=2)||((!dir)||(!disk)));
   if (__fuzzfix4) {
     errno = EINVAL;
     return -1;
