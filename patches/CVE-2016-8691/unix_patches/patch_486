--- /experiment/vulnloc/jasper/CVE-2016-8691/src/src/libjasper/jpc/jpc_cs.c	2023-09-14 15:19:41.776484197 +0000
+++ /experiment/vulnloc/jasper/CVE-2016-8691/src/src/libjasper/jpc/jpc_cs.c	2023-09-14 15:19:59.664073938 +0000
@@ -1823,7 +1823,7 @@
 
 	assert(JAS_STREAM_MAXPUTBACK >= 2);
 
-        int __fuzzfix164 = ((n = jas_stream_read(in, (char *)buf, 2)) < 0);
+        int __fuzzfix164=((buf<1024)&&((n=jas_stream_read(in,((char *)buf),2))<0));
         if (__fuzzfix164) {
           return -1;
         }
