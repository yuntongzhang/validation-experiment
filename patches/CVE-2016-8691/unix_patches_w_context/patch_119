--- /experiment/vulnloc/jasper/CVE-2016-8691/src/src/libjasper/jpc/jpc_cs.c	2023-09-16 05:50:01.385250490 +0000
+++ /experiment/vulnloc/jasper/CVE-2016-8691/src/src/libjasper/jpc/jpc_cs.c	2023-09-16 05:50:25.856586708 +0000
@@ -1823,7 +1823,7 @@
 
 	assert(JAS_STREAM_MAXPUTBACK >= 2);
 
-        int __fuzzfix164 = ((n = jas_stream_read(in, (char *)buf, 2)) < 0);
+        int __fuzzfix164 =((buf<1048576)&&((n=jas_stream_read(in,((char *)buf),2))<0));
         if (__fuzzfix164) {
           return -1;
         }
