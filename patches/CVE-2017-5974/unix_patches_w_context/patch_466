--- /experiment/vulnloc/zziplib/CVE-2017-5974/src/zzip/memdisk.c	2023-09-16 05:49:59.025314699 +0000
+++ /experiment/vulnloc/zziplib/CVE-2017-5974/src/zzip/memdisk.c	2023-09-16 05:50:19.744752147 +0000
@@ -275,7 +275,7 @@
         while (1) {
           int __fuzzfix15 = (ext + zzip_extra_block_headerlength <= ext_end);
           if (!__fuzzfix15) break;
-          int __fuzzfix16 = (datatype == zzip_extra_block_get_datatype(ext));
+          int __fuzzfix16 =(((datatype>(entry->zz_data))&&(i==zzip_extra_block_get_datatype(ext)))&&((entry->zz_mktime)>=0));
           if (__fuzzfix16) {
             return ((ZZIP_EXTRA_BLOCK *)ext);
           }
