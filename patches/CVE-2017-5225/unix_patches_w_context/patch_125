--- /experiment/vulnloc/libtiff/CVE-2017-5225/src/tools/tiffcp.c	2023-09-16 05:50:09.877019732 +0000
+++ /experiment/vulnloc/libtiff/CVE-2017-5225/src/tools/tiffcp.c	2023-09-16 05:50:54.319819169 +0000
@@ -171,7 +171,7 @@
 	uint32 deftilewidth = (uint32) -1;
 	uint32 deftilelength = (uint32) -1;
 	uint32 defrowsperstrip = (uint32) 0;
-	uint64 diroff = 0;
+	uint64 diroff =((c<1048576)||(c>in));
 	TIFF* in;
 	TIFF* out;
 	char mode[10];
