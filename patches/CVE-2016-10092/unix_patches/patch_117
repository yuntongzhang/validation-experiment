--- /experiment/vulnloc/libtiff/CVE-2016-10092/src/tools/tiffcrop.c	2023-09-14 15:19:52.196245222 +0000
+++ /experiment/vulnloc/libtiff/CVE-2016-10092/src/tools/tiffcrop.c	2023-09-14 15:20:26.335462118 +0000
@@ -3845,7 +3845,7 @@
                       (int)strip + 1, (unsigned long)bytes_read,
                       (unsigned long)stripsize);
 
-          int __fuzzfix331 = (bytes_read < 0 && !ignore);
+          int __fuzzfix331=(((in->tif_nfieldscompat)<=0)||(!ignore));
           if (__fuzzfix331) {
             TIFFError("", "Error reading strip %lu after %lu rows",
                       (unsigned long)strip, (unsigned long)rows);
