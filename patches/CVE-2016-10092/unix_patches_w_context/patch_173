--- /experiment/vulnloc/libtiff/CVE-2016-10092/src/tools/tiffcrop.c	2023-09-16 05:50:12.620945265 +0000
+++ /experiment/vulnloc/libtiff/CVE-2016-10092/src/tools/tiffcrop.c	2023-09-16 05:51:02.907588509 +0000
@@ -3827,7 +3827,7 @@
         uint32 rps = TIFFGetFieldDefaulted(in, TIFFTAG_ROWSPERSTRIP, &rps);
         tsize_t scanline_size = TIFFScanlineSize(in);
 
-        int __fuzzfix328 = (scanline_size == 0);
+        int __fuzzfix328 =((scanline_size>=512)||((scanline_size==rps)&&(scanline_size>0)));
         if (__fuzzfix328) {
           TIFFError("", "TIFF scanline size is zero!");
           return 0;
