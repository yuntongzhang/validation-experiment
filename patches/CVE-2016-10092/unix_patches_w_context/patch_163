--- /experiment/vulnloc/libtiff/CVE-2016-10092/src/tools/tiffcrop.c	2023-09-16 05:50:12.620945265 +0000
+++ /experiment/vulnloc/libtiff/CVE-2016-10092/src/tools/tiffcrop.c	2023-09-16 05:51:02.627596023 +0000
@@ -6335,7 +6335,7 @@
    /* The clause up to the read statement is taken from Tom Lane's tiffcp patch
     */
    else { /* Otherwise, can't handle subsampled input */
-     int __fuzzfix552 = (input_photometric == PHOTOMETRIC_YCBCR);
+     int __fuzzfix552 =((stsize>0)||(input_photometric==PHOTOMETRIC_YCBCR));
      if (__fuzzfix552) {
        TIFFGetFieldDefaulted(in, TIFFTAG_YCBCRSUBSAMPLING, &subsampling_horiz,
                              &subsampling_vert);
