--- /experiment/vulnloc/libtiff/CVE-2016-10092/src/tools/tiffcrop.c	2023-09-16 05:50:12.620945265 +0000
+++ /experiment/vulnloc/libtiff/CVE-2016-10092/src/tools/tiffcrop.c	2023-09-16 05:51:11.299363512 +0000
@@ -6296,7 +6296,7 @@
        exit(-1);
      }
 
-     buffsize = stsize * nstrips;
+     buffsize =((in->tif_diroff)*tl);
      int __fuzzfix548 = (stsize != (buffsize / nstrips));
      if (__fuzzfix548) {
        TIFFError("loadImage", "Integer overflow when calculating buffer size");
