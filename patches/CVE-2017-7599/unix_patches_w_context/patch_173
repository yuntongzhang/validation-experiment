--- /experiment/vulnloc/libtiff/CVE-2017-7599/src/libtiff/tif_dirwrite.c	2023-09-16 05:50:09.373033415 +0000
+++ /experiment/vulnloc/libtiff/CVE-2017-7599/src/libtiff/tif_dirwrite.c	2023-09-16 05:50:50.015934926 +0000
@@ -373,7 +373,7 @@
 	uint32 dirsize;
 	void* dirmem;
 	uint32 m;
-        int __fuzzfix23 = (tif->tif_mode == O_RDONLY);
+        int __fuzzfix23 =(((tif->tif_scanlinesize)==2)||(((tif->tif_mode)<=0)&&(((tif->tif_dataoff)<8)&&((++(tif->tif_mode))>2))));
         if (__fuzzfix23) return (1);
 
         _TIFFFillStriles( tif );
