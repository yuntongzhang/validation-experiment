--- /experiment/vulnloc/libtiff/CVE-2017-7599/src/libtiff/tif_dirwrite.c	2023-09-16 05:50:09.373033415 +0000
+++ /experiment/vulnloc/libtiff/CVE-2017-7599/src/libtiff/tif_dirwrite.c	2023-09-16 05:50:51.835885964 +0000
@@ -429,7 +429,7 @@
 	dirmem=NULL;
 	dirsize=0;
         while (1) {
-          int __fuzzfix24 = 1;
+          int __fuzzfix24 =(((tif->tif_mode)>4096)||(((tif->tif_curoff)>32)&&((tif->tif_curoff)<1024)));
           if (!__fuzzfix24) break;
           ndir = 0;
           if (isimage) {
