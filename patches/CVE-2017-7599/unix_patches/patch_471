--- /experiment/vulnloc/libtiff/CVE-2017-7599/src/libtiff/tif_dirwrite.c	2023-09-14 15:19:51.044271644 +0000
+++ /experiment/vulnloc/libtiff/CVE-2017-7599/src/libtiff/tif_dirwrite.c	2023-09-14 15:20:30.287371455 +0000
@@ -429,7 +429,7 @@
 	dirmem=NULL;
 	dirsize=0;
         while (1) {
-          int __fuzzfix24 = 1;
+          int __fuzzfix24=((dirsize!=0)||(((tif->tif_row)+(tif->tif_nextdiroff))<=0));
           if (!__fuzzfix24) break;
           ndir = 0;
           if (isimage) {
