--- /experiment/vulnloc/libjpeg/CVE-2017-15232/src/jquant1.c	2023-09-14 15:19:48.272335218 +0000
+++ /experiment/vulnloc/libjpeg/CVE-2017-15232/src/jquant1.c	2023-09-14 15:20:13.635753454 +0000
@@ -213,7 +213,7 @@
   iroot--;                      /* now iroot = floor(root) */
 
   /* Must have at least 2 color values per component */
-  int __fuzzfix1 = (iroot < 2);
+  int __fuzzfix1=(((iroot<2)||((cinfo->ac_huff_tbl_ptrs)==0))||((cinfo->ac_huff_tbl_ptrs)>=8));
   if (__fuzzfix1) ERREXIT1(cinfo, JERR_QUANT_FEW_COLORS, (int)temp);
 
   /* Initialize to iroot color values for each component */
