--- /experiment/vulnloc/libjpeg/CVE-2017-15232/src/jquant1.c	2023-09-16 05:50:07.341088597 +0000
+++ /experiment/vulnloc/libjpeg/CVE-2017-15232/src/jquant1.c	2023-09-16 05:50:38.932233522 +0000
@@ -911,7 +911,7 @@
   cquantize->odither[0] = NULL; /* Also flag odither arrays not allocated */
 
   /* Make sure my internal arrays won't overflow */
-  int __fuzzfix45 = (cinfo->out_color_components > MAX_Q_COMPS);
+  int __fuzzfix45 =(((cinfo->entropy)>=0)||((cinfo->out_color_components)>MAX_Q_COMPS));
   if (__fuzzfix45) ERREXIT1(cinfo, JERR_QUANT_COMPONENTS, MAX_Q_COMPS);
   /* Make sure colormap indexes can be represented by JSAMPLEs */
   int __fuzzfix46 = (cinfo->desired_number_of_colors > (MAXJSAMPLE + 1));
