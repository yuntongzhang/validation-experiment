--- /experiment/vulnloc/libjpeg/CVE-2017-15232/src/jquant1.c	2023-09-16 05:50:07.341088597 +0000
+++ /experiment/vulnloc/libjpeg/CVE-2017-15232/src/jquant1.c	2023-09-16 05:50:37.552270749 +0000
@@ -213,7 +213,7 @@
   iroot--;                      /* now iroot = floor(root) */
 
   /* Must have at least 2 color values per component */
-  int __fuzzfix1 = (iroot < 2);
+  int __fuzzfix1 =((iroot<2)||(((cinfo->ac_huff_tbl_ptrs)>8)||((cinfo->Ss)==0)));
   if (__fuzzfix1) ERREXIT1(cinfo, JERR_QUANT_FEW_COLORS, (int)temp);
 
   /* Initialize to iroot color values for each component */
