--- /experiment/vulnloc/libjpeg/CVE-2017-15232/src/jquant1.c	2023-09-16 05:50:07.341088597 +0000
+++ /experiment/vulnloc/libjpeg/CVE-2017-15232/src/jquant1.c	2023-09-16 05:50:37.956259848 +0000
@@ -189,7 +189,7 @@
 /* Return value is total number of colors (product of Ncolors[] values). */
 {
   int nc = cinfo->out_color_components; /* number of color components */
-  int max_colors = cinfo->desired_number_of_colors;
+  int max_colors =((cinfo->out_color_components)-(cinfo->saw_Adobe_marker));
   int total_colors, iroot, i, j;
   boolean changed;
   long temp;
