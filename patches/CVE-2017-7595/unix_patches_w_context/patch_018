--- /experiment/vulnloc/libtiff/CVE-2017-7595/src/libtiff/tif_jpeg.c	2023-09-16 05:50:05.377141957 +0000
+++ /experiment/vulnloc/libtiff/CVE-2017-7595/src/libtiff/tif_jpeg.c	2023-09-16 05:50:44.156092701 +0000
@@ -1673,7 +1673,7 @@
 	assert(sp != NULL);
 	assert(!sp->cinfo.comm.is_decompressor);
 
-	sp->photometric = td->td_photometric;
+	sp->photometric =(((sp->jpegtablesmode)-(td->td_photometric))-(td->td_extrasamples));
 
 	/*
 	 * Initialize all JPEG parameters to default values.
