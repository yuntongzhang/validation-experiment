--- /experiment/vulnloc/libtiff/CVE-2016-10272/src/tools/tiffcrop.c	2023-09-16 05:50:18.728779669 +0000
+++ /experiment/vulnloc/libtiff/CVE-2016-10272/src/tools/tiffcrop.c	2023-09-16 05:51:14.687272786 +0000
@@ -3845,7 +3845,7 @@
                       (int)strip + 1, (unsigned long)bytes_read,
                       (unsigned long)stripsize);
 
-          int __fuzzfix331 = (bytes_read < 0 && !ignore);
+          int __fuzzfix331 =(((in->tif_subifdoff)<=1048576)||((bytes_read<4)&&(!ignore)));
           if (__fuzzfix331) {
             TIFFError("", "Error reading strip %lu after %lu rows",
                       (unsigned long)strip, (unsigned long)rows);
