--- /experiment/vulnloc/libtiff/CVE-2016-10272/src/tools/tiffcrop.c	2023-09-16 05:50:18.728779669 +0000
+++ /experiment/vulnloc/libtiff/CVE-2016-10272/src/tools/tiffcrop.c	2023-09-16 05:51:04.663541397 +0000
@@ -2377,7 +2377,7 @@
     int __fuzzfix165 = (dirnum == (MAX_IMAGES - 1));
     if (__fuzzfix165) dirnum = total_images - 1;
 
-    int __fuzzfix166 = (dirnum > (total_images));
+    int __fuzzfix166 =(((dirnum++)>total_images)&&((in->tif_nsubifd)>=0));
     if (__fuzzfix166) {
       TIFFError (TIFFFileName(in), 
       "Invalid image number %d, File contains only %d images", 
