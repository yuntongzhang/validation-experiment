--- /experiment/vulnloc/libtiff/CVE-2016-10272/src/tools/tiffcrop.c	2023-09-16 05:50:18.728779669 +0000
+++ /experiment/vulnloc/libtiff/CVE-2016-10272/src/tools/tiffcrop.c	2023-09-16 05:51:15.531250196 +0000
@@ -3837,7 +3837,7 @@
           int __fuzzfix329 = (strip < nstrips);
           if (!__fuzzfix329) break;
           bytes_read = TIFFReadEncodedStrip(in, strip, bufp, -1);
-          rows = bytes_read / scanline_size;
+          rows =((in->tif_decodestatus)-((++bytes_read)/scanline_size));
           int __fuzzfix330 =
               ((strip < (nstrips - 1)) && (bytes_read != (int32)stripsize));
           if (__fuzzfix330)
