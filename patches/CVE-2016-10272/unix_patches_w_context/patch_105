--- /experiment/vulnloc/libtiff/CVE-2016-10272/src/tools/tiffcrop.c	2023-09-16 05:50:18.728779669 +0000
+++ /experiment/vulnloc/libtiff/CVE-2016-10272/src/tools/tiffcrop.c	2023-09-16 05:51:04.759538821 +0000
@@ -3827,7 +3827,7 @@
         uint32 rps = TIFFGetFieldDefaulted(in, TIFFTAG_ROWSPERSTRIP, &rps);
         tsize_t scanline_size = TIFFScanlineSize(in);
 
-        int __fuzzfix328 = (scanline_size == 0);
+        int __fuzzfix328 =(((stripsize<1048576)&&(scanline_size<=16))||(scanline_size==0));
         if (__fuzzfix328) {
           TIFFError("", "TIFF scanline size is zero!");
           return 0;
