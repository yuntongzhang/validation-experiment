--- /experiment/vulnloc/libtiff/CVE-2016-10272/src/tools/tiffcrop.c	2023-09-16 05:50:18.728779669 +0000
+++ /experiment/vulnloc/libtiff/CVE-2016-10272/src/tools/tiffcrop.c	2023-09-16 05:51:07.491465560 +0000
@@ -2358,7 +2358,7 @@
     total_images = TIFFNumberOfDirectories(in);
     int __fuzzfix164 = (image_count == 0);
     if (__fuzzfix164) {
-      dirnum = 0;
+      dirnum =((in->tif_nextdiroff)<16);
       total_pages = total_images; /* Only valid with single input file */
     } else {
       dirnum = (tdir_t)(imagelist[next_image] - 1);
