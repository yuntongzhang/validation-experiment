--- /experiment/vulnloc/libtiff/CVE-2016-10272/src/tools/tiffcrop.c	2023-09-14 15:19:58.360103847 +0000
+++ /experiment/vulnloc/libtiff/CVE-2016-10272/src/tools/tiffcrop.c	2023-09-14 15:20:36.627226003 +0000
@@ -6288,7 +6288,7 @@
      TIFFGetFieldDefaulted(in, TIFFTAG_ROWSPERSTRIP, &rowsperstrip);
      stsize = TIFFStripSize(in);
      nstrips = TIFFNumberOfStrips(in);
-     int __fuzzfix547 = (nstrips == 0 || stsize == 0);
+     int __fuzzfix547=(((nstrips==0)||(stsize==0))||((in->tif_fieldscompat)<4));
      if (__fuzzfix547) {
        TIFFError("loadImage",
                  "File appears to be striped, but the number of stipes or "
