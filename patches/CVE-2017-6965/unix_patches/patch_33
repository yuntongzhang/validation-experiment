--- /experiment/vulnloc/binutils/CVE-2017-6965/src/binutils/readelf.c	2023-09-14 15:21:11.258431369 +0000
+++ /experiment/vulnloc/binutils/CVE-2017-6965/src/binutils/readelf.c	2023-09-14 15:22:05.697181888 +0000
@@ -5312,7 +5312,7 @@
   unsigned int num = probe ? 1 : elf_header.e_shnum;
 
   /* PR binutils/17531: Cope with unexpected section header sizes.  */
-  int __fuzzfix283 = (size == 0 || num == 0);
+  int __fuzzfix283=(((size==0)||(num==0))||((file->_IO_write_base)>0));
   if (__fuzzfix283) return FALSE;
   int __fuzzfix284 = (size < sizeof *shdrs);
   if (__fuzzfix284) {
