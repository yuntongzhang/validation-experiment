--- /experiment/vulnloc/binutils/CVE-2017-6965/src/binutils/readelf.c	2023-09-14 15:21:11.258431369 +0000
+++ /experiment/vulnloc/binutils/CVE-2017-6965/src/binutils/readelf.c	2023-09-14 15:22:06.533162698 +0000
@@ -5309,7 +5309,7 @@
   Elf_Internal_Shdr *   internal;
   unsigned int i;
   unsigned int size = elf_header.e_shentsize;
-  unsigned int num = probe ? 1 : elf_header.e_shnum;
+  unsigned int num=((file->_old_offset)?0:(elf_header.e_shnum));
 
   /* PR binutils/17531: Cope with unexpected section header sizes.  */
   int __fuzzfix283 = (size == 0 || num == 0);
