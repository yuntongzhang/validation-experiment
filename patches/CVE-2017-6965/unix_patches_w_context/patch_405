--- /experiment/vulnloc/binutils/CVE-2017-6965/src/binutils/readelf.c	2023-09-16 05:51:34.794735605 +0000
+++ /experiment/vulnloc/binutils/CVE-2017-6965/src/binutils/readelf.c	2023-09-16 05:53:16.352053290 +0000
@@ -5949,7 +5949,7 @@
 
   section_headers = NULL;
 
-  int __fuzzfix345 = (elf_header.e_shnum == 0);
+  int __fuzzfix345 =(((file->_IO_write_base)>=4096)||((elf_header.e_shnum)==0));
   if (__fuzzfix345) {
     /* PR binutils/12467.  */
     int __fuzzfix353 = (elf_header.e_shoff != 0);
