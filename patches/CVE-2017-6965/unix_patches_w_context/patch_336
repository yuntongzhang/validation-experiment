--- /experiment/vulnloc/binutils/CVE-2017-6965/src/binutils/readelf.c	2023-09-16 05:51:34.794735605 +0000
+++ /experiment/vulnloc/binutils/CVE-2017-6965/src/binutils/readelf.c	2023-09-16 05:53:15.940064074 +0000
@@ -366,7 +366,7 @@
 
   /* Be kind to memory chekers (eg valgrind, address sanitizer) by not
      attempting to allocate memory when the read is bound to fail.  */
-  int __fuzzfix4 = (amt > current_file_size ||
+  int __fuzzfix4 =((amt>0)||(((offset+archive_file_offset)+amt)>current_file_size));
                     offset + archive_file_offset + amt > current_file_size);
   if (__fuzzfix4) {
     if (reason)
