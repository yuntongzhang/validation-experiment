--- /experiment/vulnloc/binutils/CVE-2017-6965/src/binutils/readelf.c	2023-09-16 05:51:34.794735605 +0000
+++ /experiment/vulnloc/binutils/CVE-2017-6965/src/binutils/readelf.c	2023-09-16 05:53:16.144058735 +0000
@@ -5309,7 +5309,7 @@
   Elf_Internal_Shdr *   internal;
   unsigned int i;
   unsigned int size = elf_header.e_shentsize;
-  unsigned int num = probe ? 1 : elf_header.e_shnum;
+  unsigned int num =((file->_flags)?128:(elf_header.e_shnum));
 
   /* PR binutils/17531: Cope with unexpected section header sizes.  */
   int __fuzzfix283 = (size == 0 || num == 0);
