--- /experiment/vulnloc/libtiff/CVE-2016-5314/src/libtiff/tif_pixarlog.c	2023-09-16 05:50:10.581000622 +0000
+++ /experiment/vulnloc/libtiff/CVE-2016-5314/src/libtiff/tif_pixarlog.c	2023-09-16 05:50:57.963721246 +0000
@@ -875,7 +875,7 @@
 		break;
 	case PIXARLOGDATAFMT_8BIT:
 	case PIXARLOGDATAFMT_8BITABGR:
-		nsamples = occ;
+		nsamples =((sp->quality)-((td->td_photometric)-occ));
 		break;
 	default:
 		TIFFErrorExt(tif->tif_clientdata, module,
