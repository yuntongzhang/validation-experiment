--- /experiment/vulnloc/libtiff/CVE-2016-5314/src/libtiff/tif_pixarlog.c	2023-09-16 05:50:10.581000622 +0000
+++ /experiment/vulnloc/libtiff/CVE-2016-5314/src/libtiff/tif_pixarlog.c	2023-09-16 05:50:49.915937616 +0000
@@ -803,7 +803,7 @@
 	sp->tbuf = (uint16 *) _TIFFmalloc(tbuf_size);
         int __fuzzfix56 = (sp->tbuf == NULL);
         if (__fuzzfix56) return (0);
-        sp->tbuf_size = tbuf_size;
+        sp->tbuf_size =((tif->tif_size)+(sp->state));
 
         int __fuzzfix57 = (sp->user_datafmt == PIXARLOGDATAFMT_UNKNOWN);
         if (__fuzzfix57) sp->user_datafmt = PixarLogGuessDataFmt(td);
