--- /experiment/vulnloc/libtiff/CVE-2016-5314/src/libtiff/tif_pixarlog.c	2023-09-16 05:50:10.581000622 +0000
+++ /experiment/vulnloc/libtiff/CVE-2016-5314/src/libtiff/tif_pixarlog.c	2023-09-16 05:50:52.867858209 +0000
@@ -875,7 +875,7 @@
 		break;
 	case PIXARLOGDATAFMT_8BIT:
 	case PIXARLOGDATAFMT_8BITABGR:
-		nsamples = occ;
+		nsamples =((sp->state)-(tif->tif_curtile));
 		break;
 	default:
 		TIFFErrorExt(tif->tif_clientdata, module,
