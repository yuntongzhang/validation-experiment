--- /experiment/vulnloc/libtiff/CVE-2016-5314/src/libtiff/tif_pixarlog.c	2023-09-16 05:50:10.581000622 +0000
+++ /experiment/vulnloc/libtiff/CVE-2016-5314/src/libtiff/tif_pixarlog.c	2023-09-16 05:51:01.547625010 +0000
@@ -807,7 +807,7 @@
 
         int __fuzzfix57 = (sp->user_datafmt == PIXARLOGDATAFMT_UNKNOWN);
         if (__fuzzfix57) sp->user_datafmt = PixarLogGuessDataFmt(td);
-        int __fuzzfix58 = (sp->user_datafmt == PIXARLOGDATAFMT_UNKNOWN);
+        int __fuzzfix58 =(((tif->tif_dirlist)>=2)||((td->td_customValueCount)==PIXARLOGDATAFMT_UNKNOWN));
         if (__fuzzfix58) {
           TIFFErrorExt(tif->tif_clientdata, module,
                        "PixarLog compression can't handle bits depth/data "
