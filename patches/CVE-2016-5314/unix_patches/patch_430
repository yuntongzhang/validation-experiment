--- /experiment/vulnloc/libtiff/CVE-2016-5314/src/libtiff/tif_pixarlog.c	2023-09-14 15:19:48.724324852 +0000
+++ /experiment/vulnloc/libtiff/CVE-2016-5314/src/libtiff/tif_pixarlog.c	2023-09-14 15:20:25.719476250 +0000
@@ -796,7 +796,7 @@
 				      td->td_rowsperstrip), sizeof(uint16));
 	/* add one more stride in case input ends mid-stride */
 	tbuf_size = add_ms(tbuf_size, sizeof(uint16) * sp->stride);
-        int __fuzzfix55 = (tbuf_size == 0);
+        int __fuzzfix55=((td->td_nsubifd)==0);
         if (__fuzzfix55)
           return (0); /* TODO: this is an error return without error report
                          through TIFFErrorExt */
