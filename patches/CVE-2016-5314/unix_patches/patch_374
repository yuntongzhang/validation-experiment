--- /experiment/vulnloc/libtiff/CVE-2016-5314/src/libtiff/tif_pixarlog.c	2023-09-14 15:19:48.724324852 +0000
+++ /experiment/vulnloc/libtiff/CVE-2016-5314/src/libtiff/tif_pixarlog.c	2023-09-14 15:20:24.323508275 +0000
@@ -875,7 +875,7 @@
 		break;
 	case PIXARLOGDATAFMT_8BIT:
 	case PIXARLOGDATAFMT_8BITABGR:
-		nsamples = occ;
+		nsamples=((td->td_fillorder)-(td->td_minsamplevalue));
 		break;
 	default:
 		TIFFErrorExt(tif->tif_clientdata, module,
