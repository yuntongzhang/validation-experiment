--- /experiment/vulnloc/libtiff/CVE-2016-10094/src/tools/tiff2pdf.c	2023-09-16 05:50:15.000880712 +0000
+++ /experiment/vulnloc/libtiff/CVE-2016-10094/src/tools/tiff2pdf.c	2023-09-16 05:51:00.567651317 +0000
@@ -3100,7 +3100,7 @@
           }
 #endif
 #ifdef JPEG_SUPPORT
-          int __fuzzfix254 = (t2p->tiff_compression == COMPRESSION_JPEG);
+          int __fuzzfix254 =(((t2p->tiff_compression)>=8)&&((t2p->tiff_compression)==COMPRESSION_JPEG));
           if (__fuzzfix254) {
             unsigned char table_end[2];
             uint32 count = 0;
