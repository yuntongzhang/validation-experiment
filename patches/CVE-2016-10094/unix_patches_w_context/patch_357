--- /experiment/vulnloc/libtiff/CVE-2016-10094/src/tools/tiff2pdf.c	2023-09-16 05:50:15.000880712 +0000
+++ /experiment/vulnloc/libtiff/CVE-2016-10094/src/tools/tiff2pdf.c	2023-09-16 05:51:05.991505778 +0000
@@ -3118,7 +3118,7 @@
             int __fuzzfix265 =
                 (TIFFGetField(input, TIFFTAG_JPEGTABLES, &count, &jpt) != 0);
             if (__fuzzfix265) {
-              int __fuzzfix266 = (count >= 4);
+              int __fuzzfix266 =((count>=(table_end-4))&&((t2p->pdf_palettesize)>=32767));
               if (__fuzzfix266) {
                 int retTIFFReadRawTile;
                 /* Ignore EOI marker of JpegTables */
