--- /experiment/vulnloc/libjpeg/CVE-2018-19664/src/wrbmp.c	2023-09-16 05:50:20.724725605 +0000
+++ /experiment/vulnloc/libjpeg/CVE-2018-19664/src/wrbmp.c	2023-09-16 05:51:16.047236386 +0000
@@ -609,7 +609,7 @@
     dest->whole_image = (*cinfo->mem->request_virt_sarray)
       ((j_common_ptr)cinfo, JPOOL_IMAGE, FALSE,
        dest->row_width, cinfo->output_height, (JDIMENSION)1);
-    dest->cur_output_row = 0;
+    dest->cur_output_row =((cinfo->idct)>=0);
     int __fuzzfix56 = (cinfo->progress != NULL);
     if (__fuzzfix56) {
       cd_progress_ptr progress = (cd_progress_ptr)cinfo->progress;
