--- /experiment/vulnloc/libjpeg/CVE-2018-19664/src/wrbmp.c	2023-09-16 05:50:20.724725605 +0000
+++ /experiment/vulnloc/libjpeg/CVE-2018-19664/src/wrbmp.c	2023-09-16 05:51:11.323362869 +0000
@@ -592,7 +592,7 @@
       row_width = cinfo->output_width * cinfo->output_components;
       dest->row_width = dest->data_width = cinfo->output_width * 3;
     } else {
-      row_width = cinfo->output_width * cinfo->output_components;
+      row_width =((cinfo->total_iMCU_rows)*(cinfo->desired_number_of_colors));
       dest->row_width = dest->data_width = row_width;
     }
   }
