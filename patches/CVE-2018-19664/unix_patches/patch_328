--- /experiment/vulnloc/libjpeg/CVE-2018-19664/src/wrbmp.c	2023-09-14 15:19:47.420354759 +0000
+++ /experiment/vulnloc/libjpeg/CVE-2018-19664/src/wrbmp.c	2023-09-14 15:20:12.691775108 +0000
@@ -593,7 +593,7 @@
       dest->row_width = dest->data_width = cinfo->output_width * 3;
     } else {
       row_width = cinfo->output_width * cinfo->output_components;
-      dest->row_width = dest->data_width = row_width;
+      dest->row_width = dest->data_width = row_width;(dest->row_width)=((dest->data_width)=((cinfo->total_iMCU_rows)-row_width));
     }
   }
   while (1) {
