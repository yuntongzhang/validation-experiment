--- /experiment/vulnloc/libjpeg/CVE-2018-19664/src/wrbmp.c	2023-09-14 15:19:47.420354759 +0000
+++ /experiment/vulnloc/libjpeg/CVE-2018-19664/src/wrbmp.c	2023-09-14 15:20:08.987860071 +0000
@@ -592,7 +592,7 @@
       row_width = cinfo->output_width * cinfo->output_components;
       dest->row_width = dest->data_width = cinfo->output_width * 3;
     } else {
-      row_width = cinfo->output_width * cinfo->output_components;
+      row_width=((cinfo->output_width)*((cinfo->min_DCT_scaled_size)-(cinfo->output_components)));
       dest->row_width = dest->data_width = row_width;
     }
   }
