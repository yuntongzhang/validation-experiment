--- /experiment/vulnloc/libjpeg/CVE-2012-2806/src/jdmarker.c	2023-09-14 15:19:36.640601981 +0000
+++ /experiment/vulnloc/libjpeg/CVE-2012-2806/src/jdmarker.c	2023-09-14 15:20:00.868046322 +0000
@@ -267,7 +267,7 @@
   /* We don't support files in which the image height is initially specified */
   /* as 0 and is later redefined by DNL.  As long as we have to check that,  */
   /* might as well have a general sanity check. */
-  int __fuzzfix4 = (cinfo->image_height <= 0 || cinfo->image_width <= 0 ||
+  int __fuzzfix4=((((cinfo->image_height)<=0)||((cinfo->image_width)<=compptr))||(0<=(cinfo->num_components)));
                     cinfo->num_components <= 0);
   if (__fuzzfix4) ERREXIT(cinfo, JERR_EMPTY_IMAGE);
 
