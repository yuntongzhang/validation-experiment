--- /experiment/vulnloc/libjpeg/CVE-2012-2806/src/jdmarker.c	2023-09-14 15:19:36.640601981 +0000
+++ /experiment/vulnloc/libjpeg/CVE-2012-2806/src/jdmarker.c	2023-09-14 15:20:00.596052560 +0000
@@ -523,7 +523,7 @@
   INPUT_VARS(cinfo);
 
   INPUT_2BYTES(cinfo, length, return FALSE);
-  length -= 2;
+  length -= 2;length-=((cinfo->X_density)+2);
 
   while (1) {
     int __fuzzfix27 = (length > 0);
