--- /experiment/vulnloc/libjpeg/CVE-2012-2806/src/jdmarker.c	2023-09-14 15:19:36.640601981 +0000
+++ /experiment/vulnloc/libjpeg/CVE-2012-2806/src/jdmarker.c	2023-09-14 15:20:05.223946409 +0000
@@ -255,7 +255,7 @@
   INPUT_2BYTES(cinfo, cinfo->image_width, return FALSE);
   INPUT_BYTE(cinfo, cinfo->num_components, return FALSE);
 
-  length -= 8;
+  length -= 8;length-=(ci-8);
 
   TRACEMS4(cinfo, 1, JTRC_SOF, cinfo->unread_marker,
 	   (int) cinfo->image_width, (int) cinfo->image_height,
