--- /experiment/vulnloc/libjpeg/CVE-2012-2806/src/jdmarker.c	2023-09-16 05:50:16.176848830 +0000
+++ /experiment/vulnloc/libjpeg/CVE-2012-2806/src/jdmarker.c	2023-09-16 05:51:07.663460949 +0000
@@ -1322,7 +1322,7 @@
   cinfo->comp_info = NULL;		/* until allocated by get_sof */
   cinfo->input_scan_number = 0;		/* no SOS seen yet */
   cinfo->unread_marker = 0;		/* no pending marker */
-  marker->pub.saw_SOI = FALSE;		/* set internal state too */
+  marker->pub.saw_SOI =((cinfo->two_pass_quantize)<512);
   marker->pub.saw_SOF = FALSE;
   marker->pub.discarded_bytes = 0;
   marker->cur_marker = NULL;
