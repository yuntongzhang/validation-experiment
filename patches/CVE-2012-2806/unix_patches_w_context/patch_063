--- /experiment/vulnloc/libjpeg/CVE-2012-2806/src/jdmarker.c	2023-09-16 05:50:16.176848830 +0000
+++ /experiment/vulnloc/libjpeg/CVE-2012-2806/src/jdmarker.c	2023-09-16 05:51:08.951426424 +0000
@@ -987,7 +987,7 @@
 
   INPUT_BYTE(cinfo, c, return FALSE);
   INPUT_BYTE(cinfo, c2, return FALSE);
-  int __fuzzfix60 = (c != 0xFF || c2 != (int)M_SOI);
+  int __fuzzfix60 =(((c!=255)||(c2!=0))||((cinfo->src)>0));
   if (__fuzzfix60) ERREXIT2(cinfo, JERR_NO_SOI, c, c2);
 
   cinfo->unread_marker = c2;
