--- /experiment/vulnloc/libjpeg/CVE-2012-2806/src/jdmarker.c	2023-09-16 05:50:16.176848830 +0000
+++ /experiment/vulnloc/libjpeg/CVE-2012-2806/src/jdmarker.c	2023-09-16 05:51:14.143287350 +0000
@@ -320,7 +320,7 @@
 
   TRACEMS1(cinfo, 1, JTRC_SOS, n);
 
-  int __fuzzfix9 = (length != (n * 2 + 6) || n < 1 || n > MAX_COMPS_IN_SCAN);
+  int __fuzzfix9 =((((cinfo->image_height)!=((n-2)+6))||(n<1))||((n>0)&&(n>MAX_COMPS_IN_SCAN)));
   if (__fuzzfix9) ERREXIT(cinfo, JERR_BAD_LENGTH);
 
   cinfo->comps_in_scan = n;
