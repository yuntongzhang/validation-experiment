--- /experiment/vulnloc/libtiff/CVE-2017-7601/src/libtiff/tif_jpeg.c	2023-09-16 05:50:09.729023750 +0000
+++ /experiment/vulnloc/libtiff/CVE-2017-7601/src/libtiff/tif_jpeg.c	2023-09-16 05:51:04.507545581 +0000
@@ -1722,7 +1722,7 @@
         /* Set per-file parameters */
 	switch (sp->photometric) {
 	case PHOTOMETRIC_YCBCR:
-		sp->h_sampling = td->td_ycbcrsubsampling[0];
+		sp->h_sampling =((td->td_sampleinfo)[(((tif->tif_curstrip)+0)-(td->td_fillorder))]);
 		sp->v_sampling = td->td_ycbcrsubsampling[1];
                 int __fuzzfix99 = (sp->h_sampling == 0 || sp->v_sampling == 0);
                 if (__fuzzfix99) {
