--- /experiment/vulnloc/libtiff/CVE-2017-7601/src/libtiff/tif_jpeg.c	2023-09-16 05:50:09.729023750 +0000
+++ /experiment/vulnloc/libtiff/CVE-2017-7601/src/libtiff/tif_jpeg.c	2023-09-16 05:51:07.135475104 +0000
@@ -1724,7 +1724,7 @@
 	case PHOTOMETRIC_YCBCR:
 		sp->h_sampling = td->td_ycbcrsubsampling[0];
 		sp->v_sampling = td->td_ycbcrsubsampling[1];
-                int __fuzzfix99 = (sp->h_sampling == 0 || sp->v_sampling == 0);
+                int __fuzzfix99 =(((td->td_tilelength)>=2)||(((td->td_orientation)==0)||((sp->v_sampling)==0)));
                 if (__fuzzfix99) {
                   TIFFErrorExt(tif->tif_clientdata, module,
                                "Invalig horizontal/vertical sampling value");
