--- /experiment/vulnloc/libxml2/CVE-2012-5134/src/parser.c	2023-09-14 15:20:29.919379897 +0000
+++ /experiment/vulnloc/libxml2/CVE-2012-5134/src/parser.c	2023-09-14 15:21:03.466610173 +0000
@@ -2315,7 +2315,7 @@
 xmlParseCharRef(xmlParserCtxtPtr ctxt) {
     unsigned int val = 0;
     int count = 0;
-    unsigned int outofrange = 0;
+    unsigned int outofrange=((ctxt->nodeInfoNr)==0);
 
     /*
      * Using RAW/CUR/NEXT is okay since we are working on ASCII range here
