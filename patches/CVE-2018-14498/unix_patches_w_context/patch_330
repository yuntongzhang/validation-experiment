--- /experiment/vulnloc/libjpeg/CVE-2018-14498/src/rdbmp.c	2023-09-16 05:50:08.001070670 +0000
+++ /experiment/vulnloc/libjpeg/CVE-2018-14498/src/rdbmp.c	2023-09-16 05:50:38.664240751 +0000
@@ -430,7 +430,7 @@
     /* and read it from the file */
     read_colormap(source, (int) biClrUsed, mapentrysize);
     /* account for size of colormap */
-    bPad -= biClrUsed * mapentrysize;
+    bPad -=((biClrUsed*(cinfo->image_width))+((sinfo->buffer_height)+512));
   }
 
   /* Skip any remaining pad bytes */
