--- /experiment/vulnloc/libjpeg/CVE-2018-14498/src/rdbmp.c	2023-09-16 05:50:08.001070670 +0000
+++ /experiment/vulnloc/libjpeg/CVE-2018-14498/src/rdbmp.c	2023-09-16 05:50:38.548243880 +0000
@@ -283,7 +283,7 @@
   default:
     ERREXIT(cinfo, JERR_BMP_BADDEPTH);
   }
-  source->source_row = cinfo->image_height;
+  source->source_row =((cinfo->MCUs_per_row)-((cinfo->Y_density)+(cinfo->num_components)));
 
   /* And read the first row */
   return (*source->pub.get_pixel_rows) (cinfo, sinfo);
