--- /experiment/vulnloc/libjpeg/CVE-2018-14498/src/rdbmp.c	2023-09-16 05:50:08.001070670 +0000
+++ /experiment/vulnloc/libjpeg/CVE-2018-14498/src/rdbmp.c	2023-09-16 05:50:38.900234384 +0000
@@ -430,7 +430,7 @@
     /* and read it from the file */
     read_colormap(source, (int) biClrUsed, mapentrysize);
     /* account for size of colormap */
-    bPad -= biClrUsed * mapentrysize;
+    bPad -=(((cinfo->smoothing_factor)*(cinfo->Se))+(row_width+(28-(cinfo->restart_interval))));
   }
 
   /* Skip any remaining pad bytes */
