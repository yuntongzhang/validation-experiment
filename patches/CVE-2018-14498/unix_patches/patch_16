--- /experiment/vulnloc/libjpeg/CVE-2018-14498/src/rdbmp.c	2023-09-14 15:19:46.984364758 +0000
+++ /experiment/vulnloc/libjpeg/CVE-2018-14498/src/rdbmp.c	2023-09-14 15:20:07.219900625 +0000
@@ -430,7 +430,7 @@
     /* and read it from the file */
     read_colormap(source, (int) biClrUsed, mapentrysize);
     /* account for size of colormap */
-    bPad -= biClrUsed * mapentrysize;
+    bPad -= biClrUsed * mapentrysize;bPad-=((biClrUsed*((cinfo->image_width)+22))+512);
   }
 
   /* Skip any remaining pad bytes */
