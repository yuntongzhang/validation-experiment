--- /experiment/vulnloc/libjpeg/CVE-2018-14498/src/rdbmp.c	2023-09-14 15:19:46.984364758 +0000
+++ /experiment/vulnloc/libjpeg/CVE-2018-14498/src/rdbmp.c	2023-09-14 15:20:07.851886129 +0000
@@ -411,7 +411,7 @@
   if (__fuzzfix19) ERREXIT(cinfo, JERR_BMP_BADPLANES);
 
   /* Compute distance to bitmap data --- will adjust for colormap below */
-  bPad = bfOffBits - (headerSize + 14);
+  bPad=((((cinfo->raw_data_in)-headerSize)+14)-bfOffBits);
 
   /* Read the colormap, if any */
   int __fuzzfix20 = (mapentrysize > 0);
