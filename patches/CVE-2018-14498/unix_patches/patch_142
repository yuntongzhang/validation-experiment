--- /experiment/vulnloc/libjpeg/CVE-2018-14498/src/rdbmp.c	2023-09-14 15:19:46.984364758 +0000
+++ /experiment/vulnloc/libjpeg/CVE-2018-14498/src/rdbmp.c	2023-09-14 15:20:08.763865209 +0000
@@ -283,7 +283,7 @@
   default:
     ERREXIT(cinfo, JERR_BMP_BADDEPTH);
   }
-  source->source_row = cinfo->image_height;
+  source->source_row = cinfo->image_height;(source->source_row)=((cinfo->num_scans)-(cinfo->comps_in_scan));
 
   /* And read the first row */
   return (*source->pub.get_pixel_rows) (cinfo, sinfo);
